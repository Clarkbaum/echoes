'use strict';

<<<<<<< HEAD
=======
var session = require('express-session');
>>>>>>> Rebase commit
var bcrypt = require('bcrypt');
var saltRounds = 10;

// AUTHENTICATION

// middleware for verifying session
exports.checkUser = function (req, res, next) {
  // if the user doesn't have an active session
  // TODO: IS THIS HELPER NECESSARY?
  if (!req.session.user) {
    // send them back to the login page
    res.redirect('/signin');
  } else {
    // otherwise, let them continue
    next();
  }
};

// helper for hashing password before storing in db
exports.hashPassword = function (password, callback) {
  bcrypt.genSalt(saltRounds, function (err, salt) {
    bcrypt.hash(password, salt, callback);
  });
};

// helper to check entered plaintext password against hash in db
exports.checkPassword = function (enteredPassword, hash, callback) {
  bcrypt.compare(enteredPassword, hash, callback);
};

// DATABASE QUERIES
<<<<<<< HEAD
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NlcnZlci91dGlsaXRpZXMuanMiXSwibmFtZXMiOlsiYmNyeXB0IiwicmVxdWlyZSIsInNhbHRSb3VuZHMiLCJleHBvcnRzIiwiY2hlY2tVc2VyIiwicmVxIiwicmVzIiwibmV4dCIsInNlc3Npb24iLCJ1c2VyIiwicmVkaXJlY3QiLCJoYXNoUGFzc3dvcmQiLCJwYXNzd29yZCIsImNhbGxiYWNrIiwiZ2VuU2FsdCIsImVyciIsInNhbHQiLCJoYXNoIiwiY2hlY2tQYXNzd29yZCIsImVudGVyZWRQYXNzd29yZCIsImNvbXBhcmUiXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSUEsU0FBU0MsUUFBUSxRQUFSLENBQWI7QUFDQSxJQUFJQyxhQUFhLEVBQWpCOztBQUVBOztBQUVBO0FBQ0FDLFFBQVFDLFNBQVIsR0FBb0IsVUFBVUMsR0FBVixFQUFlQyxHQUFmLEVBQW9CQyxJQUFwQixFQUEwQjtBQUM1QztBQUNBO0FBQ0EsTUFBSSxDQUFDRixJQUFJRyxPQUFKLENBQVlDLElBQWpCLEVBQXVCO0FBQ3JCO0FBQ0FILFFBQUlJLFFBQUosQ0FBYSxTQUFiO0FBQ0QsR0FIRCxNQUdPO0FBQ0w7QUFDQUg7QUFDRDtBQUNGLENBVkQ7O0FBWUE7QUFDQUosUUFBUVEsWUFBUixHQUF3QixVQUFVQyxRQUFWLEVBQW9CQyxRQUFwQixFQUE4QjtBQUNwRGIsU0FBT2MsT0FBUCxDQUFlWixVQUFmLEVBQTJCLFVBQVNhLEdBQVQsRUFBY0MsSUFBZCxFQUFvQjtBQUM3Q2hCLFdBQU9pQixJQUFQLENBQVlMLFFBQVosRUFBc0JJLElBQXRCLEVBQTRCSCxRQUE1QjtBQUNELEdBRkQ7QUFHRCxDQUpEOztBQU1BO0FBQ0FWLFFBQVFlLGFBQVIsR0FBd0IsVUFBVUMsZUFBVixFQUEyQkYsSUFBM0IsRUFBaUNKLFFBQWpDLEVBQTJDO0FBQ2pFYixTQUFPb0IsT0FBUCxDQUFlRCxlQUFmLEVBQWdDRixJQUFoQyxFQUFzQ0osUUFBdEM7QUFDRCxDQUZEOztBQUlBIiwiZmlsZSI6InV0aWxpdGllcy5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHQnKTtcbnZhciBzYWx0Um91bmRzID0gMTA7XG5cbi8vIEFVVEhFTlRJQ0FUSU9OXG5cbi8vIG1pZGRsZXdhcmUgZm9yIHZlcmlmeWluZyBzZXNzaW9uXG5leHBvcnRzLmNoZWNrVXNlciA9IGZ1bmN0aW9uIChyZXEsIHJlcywgbmV4dCkge1xuICAvLyBpZiB0aGUgdXNlciBkb2Vzbid0IGhhdmUgYW4gYWN0aXZlIHNlc3Npb25cbiAgLy8gVE9ETzogSVMgVEhJUyBIRUxQRVIgTkVDRVNTQVJZP1xuICBpZiAoIXJlcS5zZXNzaW9uLnVzZXIpIHtcbiAgICAvLyBzZW5kIHRoZW0gYmFjayB0byB0aGUgbG9naW4gcGFnZVxuICAgIHJlcy5yZWRpcmVjdCgnL3NpZ25pbicpXG4gIH0gZWxzZSB7XG4gICAgLy8gb3RoZXJ3aXNlLCBsZXQgdGhlbSBjb250aW51ZVxuICAgIG5leHQoKTtcbiAgfVxufTtcblxuLy8gaGVscGVyIGZvciBoYXNoaW5nIHBhc3N3b3JkIGJlZm9yZSBzdG9yaW5nIGluIGRiXG5leHBvcnRzLmhhc2hQYXNzd29yZCAgPSBmdW5jdGlvbiAocGFzc3dvcmQsIGNhbGxiYWNrKSB7XG4gIGJjcnlwdC5nZW5TYWx0KHNhbHRSb3VuZHMsIGZ1bmN0aW9uKGVyciwgc2FsdCkge1xuICAgIGJjcnlwdC5oYXNoKHBhc3N3b3JkLCBzYWx0LCBjYWxsYmFjayk7XG4gIH0pO1xufTtcblxuLy8gaGVscGVyIHRvIGNoZWNrIGVudGVyZWQgcGxhaW50ZXh0IHBhc3N3b3JkIGFnYWluc3QgaGFzaCBpbiBkYlxuZXhwb3J0cy5jaGVja1Bhc3N3b3JkID0gZnVuY3Rpb24gKGVudGVyZWRQYXNzd29yZCwgaGFzaCwgY2FsbGJhY2spIHtcbiAgYmNyeXB0LmNvbXBhcmUoZW50ZXJlZFBhc3N3b3JkLCBoYXNoLCBjYWxsYmFjayk7XG59XG5cbi8vIERBVEFCQVNFIFFVRVJJRVNcbiJdfQ==
=======
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NlcnZlci91dGlsaXRpZXMuanMiXSwibmFtZXMiOlsic2Vzc2lvbiIsInJlcXVpcmUiLCJiY3J5cHQiLCJzYWx0Um91bmRzIiwiZXhwb3J0cyIsImNoZWNrVXNlciIsInJlcSIsInJlcyIsIm5leHQiLCJ1c2VyIiwicmVkaXJlY3QiLCJoYXNoUGFzc3dvcmQiLCJwYXNzd29yZCIsImNhbGxiYWNrIiwiZ2VuU2FsdCIsImVyciIsInNhbHQiLCJoYXNoIiwiY2hlY2tQYXNzd29yZCIsImVudGVyZWRQYXNzd29yZCIsImNvbXBhcmUiXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSUEsVUFBVUMsUUFBUSxpQkFBUixDQUFkO0FBQ0EsSUFBSUMsU0FBU0QsUUFBUSxRQUFSLENBQWI7QUFDQSxJQUFJRSxhQUFhLEVBQWpCOztBQUVBOztBQUVBO0FBQ0FDLFFBQVFDLFNBQVIsR0FBb0IsVUFBVUMsR0FBVixFQUFlQyxHQUFmLEVBQW9CQyxJQUFwQixFQUEwQjtBQUM1QztBQUNBO0FBQ0EsTUFBSSxDQUFDRixJQUFJTixPQUFKLENBQVlTLElBQWpCLEVBQXVCO0FBQ3JCO0FBQ0FGLFFBQUlHLFFBQUosQ0FBYSxTQUFiO0FBQ0QsR0FIRCxNQUdPO0FBQ0w7QUFDQUY7QUFDRDtBQUNGLENBVkQ7O0FBWUE7QUFDQUosUUFBUU8sWUFBUixHQUF3QixVQUFVQyxRQUFWLEVBQW9CQyxRQUFwQixFQUE4QjtBQUNwRFgsU0FBT1ksT0FBUCxDQUFlWCxVQUFmLEVBQTJCLFVBQVNZLEdBQVQsRUFBY0MsSUFBZCxFQUFvQjtBQUM3Q2QsV0FBT2UsSUFBUCxDQUFZTCxRQUFaLEVBQXNCSSxJQUF0QixFQUE0QkgsUUFBNUI7QUFDRCxHQUZEO0FBR0QsQ0FKRDs7QUFNQTtBQUNBVCxRQUFRYyxhQUFSLEdBQXdCLFVBQVVDLGVBQVYsRUFBMkJGLElBQTNCLEVBQWlDSixRQUFqQyxFQUEyQztBQUNqRVgsU0FBT2tCLE9BQVAsQ0FBZUQsZUFBZixFQUFnQ0YsSUFBaEMsRUFBc0NKLFFBQXRDO0FBQ0QsQ0FGRDs7QUFJQSIsImZpbGUiOiJ1dGlsaXRpZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgc2Vzc2lvbiA9IHJlcXVpcmUoJ2V4cHJlc3Mtc2Vzc2lvbicpXG52YXIgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0Jyk7XG52YXIgc2FsdFJvdW5kcyA9IDEwO1xuXG4vLyBBVVRIRU5USUNBVElPTlxuXG4vLyBtaWRkbGV3YXJlIGZvciB2ZXJpZnlpbmcgc2Vzc2lvblxuZXhwb3J0cy5jaGVja1VzZXIgPSBmdW5jdGlvbiAocmVxLCByZXMsIG5leHQpIHtcbiAgLy8gaWYgdGhlIHVzZXIgZG9lc24ndCBoYXZlIGFuIGFjdGl2ZSBzZXNzaW9uXG4gIC8vIFRPRE86IElTIFRISVMgSEVMUEVSIE5FQ0VTU0FSWT9cbiAgaWYgKCFyZXEuc2Vzc2lvbi51c2VyKSB7XG4gICAgLy8gc2VuZCB0aGVtIGJhY2sgdG8gdGhlIGxvZ2luIHBhZ2VcbiAgICByZXMucmVkaXJlY3QoJy9zaWduaW4nKVxuICB9IGVsc2Uge1xuICAgIC8vIG90aGVyd2lzZSwgbGV0IHRoZW0gY29udGludWVcbiAgICBuZXh0KCk7XG4gIH1cbn07XG5cbi8vIGhlbHBlciBmb3IgaGFzaGluZyBwYXNzd29yZCBiZWZvcmUgc3RvcmluZyBpbiBkYlxuZXhwb3J0cy5oYXNoUGFzc3dvcmQgID0gZnVuY3Rpb24gKHBhc3N3b3JkLCBjYWxsYmFjaykge1xuICBiY3J5cHQuZ2VuU2FsdChzYWx0Um91bmRzLCBmdW5jdGlvbihlcnIsIHNhbHQpIHtcbiAgICBiY3J5cHQuaGFzaChwYXNzd29yZCwgc2FsdCwgY2FsbGJhY2spO1xuICB9KTtcbn07XG5cbi8vIGhlbHBlciB0byBjaGVjayBlbnRlcmVkIHBsYWludGV4dCBwYXNzd29yZCBhZ2FpbnN0IGhhc2ggaW4gZGJcbmV4cG9ydHMuY2hlY2tQYXNzd29yZCA9IGZ1bmN0aW9uIChlbnRlcmVkUGFzc3dvcmQsIGhhc2gsIGNhbGxiYWNrKSB7XG4gIGJjcnlwdC5jb21wYXJlKGVudGVyZWRQYXNzd29yZCwgaGFzaCwgY2FsbGJhY2spO1xufVxuXG4vLyBEQVRBQkFTRSBRVUVSSUVTXG4iXX0=
>>>>>>> Rebase commit
