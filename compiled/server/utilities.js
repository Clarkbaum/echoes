'use strict';

var bcrypt = require('bcrypt');
var saltRounds = 10;

// AUTHENTICATION

// middleware for verifying session
exports.checkUser = function (req, res, next) {
  // if the user doesn't have an active session
  // TODO: IS THIS HELPER NECESSARY?
  if (!req.session.user) {
    // send them back to the login page
    res.redirect('/signin');
  } else {
    // otherwise, let them continue
    next();
  }
};

// helper for hashing password before storing in db
exports.hashPassword = function (password, callback) {
  bcrypt.genSalt(saltRounds, function (err, salt) {
    bcrypt.hash(password, salt, callback);
  });
};

// helper to check entered plaintext password against hash in db
exports.checkPassword = function (enteredPassword, hash, callback) {
  bcrypt.compare(enteredPassword, hash, callback);
};

// DATABASE QUERIES
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NlcnZlci91dGlsaXRpZXMuanMiXSwibmFtZXMiOlsiYmNyeXB0IiwicmVxdWlyZSIsInNhbHRSb3VuZHMiLCJleHBvcnRzIiwiY2hlY2tVc2VyIiwicmVxIiwicmVzIiwibmV4dCIsInNlc3Npb24iLCJ1c2VyIiwicmVkaXJlY3QiLCJoYXNoUGFzc3dvcmQiLCJwYXNzd29yZCIsImNhbGxiYWNrIiwiZ2VuU2FsdCIsImVyciIsInNhbHQiLCJoYXNoIiwiY2hlY2tQYXNzd29yZCIsImVudGVyZWRQYXNzd29yZCIsImNvbXBhcmUiXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSUEsU0FBU0MsUUFBUSxRQUFSLENBQWI7QUFDQSxJQUFJQyxhQUFhLEVBQWpCOztBQUVBOztBQUVBO0FBQ0FDLFFBQVFDLFNBQVIsR0FBb0IsVUFBVUMsR0FBVixFQUFlQyxHQUFmLEVBQW9CQyxJQUFwQixFQUEwQjtBQUM1QztBQUNBO0FBQ0EsTUFBSSxDQUFDRixJQUFJRyxPQUFKLENBQVlDLElBQWpCLEVBQXVCO0FBQ3JCO0FBQ0FILFFBQUlJLFFBQUosQ0FBYSxTQUFiO0FBQ0QsR0FIRCxNQUdPO0FBQ0w7QUFDQUg7QUFDRDtBQUNGLENBVkQ7O0FBWUE7QUFDQUosUUFBUVEsWUFBUixHQUF3QixVQUFVQyxRQUFWLEVBQW9CQyxRQUFwQixFQUE4QjtBQUNwRGIsU0FBT2MsT0FBUCxDQUFlWixVQUFmLEVBQTJCLFVBQVNhLEdBQVQsRUFBY0MsSUFBZCxFQUFvQjtBQUM3Q2hCLFdBQU9pQixJQUFQLENBQVlMLFFBQVosRUFBc0JJLElBQXRCLEVBQTRCSCxRQUE1QjtBQUNELEdBRkQ7QUFHRCxDQUpEOztBQU1BO0FBQ0FWLFFBQVFlLGFBQVIsR0FBd0IsVUFBVUMsZUFBVixFQUEyQkYsSUFBM0IsRUFBaUNKLFFBQWpDLEVBQTJDO0FBQ2pFYixTQUFPb0IsT0FBUCxDQUFlRCxlQUFmLEVBQWdDRixJQUFoQyxFQUFzQ0osUUFBdEM7QUFDRCxDQUZEOztBQUlBIiwiZmlsZSI6InV0aWxpdGllcy5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHQnKTtcbnZhciBzYWx0Um91bmRzID0gMTA7XG5cbi8vIEFVVEhFTlRJQ0FUSU9OXG5cbi8vIG1pZGRsZXdhcmUgZm9yIHZlcmlmeWluZyBzZXNzaW9uXG5leHBvcnRzLmNoZWNrVXNlciA9IGZ1bmN0aW9uIChyZXEsIHJlcywgbmV4dCkge1xuICAvLyBpZiB0aGUgdXNlciBkb2Vzbid0IGhhdmUgYW4gYWN0aXZlIHNlc3Npb25cbiAgLy8gVE9ETzogSVMgVEhJUyBIRUxQRVIgTkVDRVNTQVJZP1xuICBpZiAoIXJlcS5zZXNzaW9uLnVzZXIpIHtcbiAgICAvLyBzZW5kIHRoZW0gYmFjayB0byB0aGUgbG9naW4gcGFnZVxuICAgIHJlcy5yZWRpcmVjdCgnL3NpZ25pbicpXG4gIH0gZWxzZSB7XG4gICAgLy8gb3RoZXJ3aXNlLCBsZXQgdGhlbSBjb250aW51ZVxuICAgIG5leHQoKTtcbiAgfVxufTtcblxuLy8gaGVscGVyIGZvciBoYXNoaW5nIHBhc3N3b3JkIGJlZm9yZSBzdG9yaW5nIGluIGRiXG5leHBvcnRzLmhhc2hQYXNzd29yZCAgPSBmdW5jdGlvbiAocGFzc3dvcmQsIGNhbGxiYWNrKSB7XG4gIGJjcnlwdC5nZW5TYWx0KHNhbHRSb3VuZHMsIGZ1bmN0aW9uKGVyciwgc2FsdCkge1xuICAgIGJjcnlwdC5oYXNoKHBhc3N3b3JkLCBzYWx0LCBjYWxsYmFjayk7XG4gIH0pO1xufTtcblxuLy8gaGVscGVyIHRvIGNoZWNrIGVudGVyZWQgcGxhaW50ZXh0IHBhc3N3b3JkIGFnYWluc3QgaGFzaCBpbiBkYlxuZXhwb3J0cy5jaGVja1Bhc3N3b3JkID0gZnVuY3Rpb24gKGVudGVyZWRQYXNzd29yZCwgaGFzaCwgY2FsbGJhY2spIHtcbiAgYmNyeXB0LmNvbXBhcmUoZW50ZXJlZFBhc3N3b3JkLCBoYXNoLCBjYWxsYmFjayk7XG59XG5cbi8vIERBVEFCQVNFIFFVRVJJRVNcbiJdfQ==